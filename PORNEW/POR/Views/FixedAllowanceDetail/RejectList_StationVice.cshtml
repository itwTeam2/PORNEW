@model PagedList.IPagedList<POR.Models.Vw_FixedAllowanceDetail>
@using PagedList.Mvc;
@using POR.Models;
@{
    ViewBag.Title = "RejectList_StationVice";
}
<div class="content-wrapper" style="height:900px !important;">

    <section class="content-header">
        <h1>
            Fixed Allowance Details
            <small>View Details</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li class="active">Dashboard</li>
        </ol>
        <div id="ErrorMessage">
            @if (TempData["ScfMsg"] != null)
            {
                <div id="Msg" class="col-lg-12  alert alert-success">
                    <button type="button" class="close" data-dismiss="alert">×</button>
                    <strong>Alert!</strong> @TempData["ScfMsg"]
                </div>
            }
            else if (TempData["ErrMsg"] != null)
            {
                <div id="Msg" class="col-lg-12 alert alert-danger">
                    <button type="button" class="close" data-dismiss="alert">×</button>
                    <strong>Alert!</strong>@TempData["ErrMsg"]
                </div>
            }
        </div>
    </section>

    <section class="col-lg-12 connectedSortable">
        <div class="nav-tabs-custom">
            @Html.ValidationSummary(true)

            <div class="box-body">

                @using (Html.BeginForm("RejectList_StationVice", "FixedAllowanceDetail", new { CommandType = "1" }, FormMethod.Get))
                {
                    dbContextCommonData _dbCommonData = new dbContextCommonData();
                    dbContext _db = new dbContext();
                    ViewBag.DDL_LocationId = new SelectList(_dbCommonData.Establishments, "LocationID", "LocationName");
                   
                    <div class="input-group col-sm-12">
                        <div class="col-sm-2" style="margin-left: 0px !important; padding-left: 0px !important; ">
                            Effective Date From
                            @Html.TextBox("EffectiveDateFrom", ViewBag.EffectiveDateFrom as string, new { @class = "form-control datepicker col-sm-2 ", autocomplete = "off", placeholder = "MM/DD/YYYY" })
                       </div>
                        <div class="col-sm-2" style="margin-left: 0px !important; padding-left: 0px !important; ">
                            Effective Date To
                            @Html.TextBox("EffectiveDateTo", ViewBag.EffectiveDateTo as string, new { @class = "form-control datepicker col-sm-2 ", autocomplete = "off", placeholder = "MM/DD/YYYY" })
                        </div>
                        <div class="col-sm-3" style="margin-left: 0px !important; padding-left: 0px !important; ">
                            Location
                            @Html.DropDownList("LocationId", ViewBag.DDL_LocationId as SelectList, "Select", htmlAttributes: new { @class = "form-control col-sm-3", id = "LocationID" })
                        </div>
                        <div class="col-sm-1" style="margin-left: 0px !important; padding-left: 0px !important; ">
                            &acute;
                            <div class="">
                                <button type="submit" class="btn btn-success"><span class="glyphicon glyphicon-search"></span> Search</button>
                            </div>
                        </div>
                        <div class="col-sm-1" style="margin-left: 0px !important; padding-left: 0px !important; ">
                            &acute;
                            <div class="">
                                <button type="button" class="btn btn-primary" onclick="PrintPreView()">
                                    <span class="glyphicon glyphicon-print"></span> Print
                                </button>
                                <script type="text/javascript">
                                    function PrintPreView() {

                                        var EffectiveDateFrom_ = document.getElementById('EffectiveDateFrom').value;
                                        var EffectiveDateTo_ = document.getElementById('EffectiveDateTo').value;
                                        var LocationId = document.getElementById('LocationID').value;
                                        var CommandType_ = 2;
                                        location.href = '@Url.Action("RejectList_StationVice", "FixedAllowanceDetail")?EffectiveDateFrom=' + EffectiveDateFrom_ + '&EffectiveDateTo=' + EffectiveDateTo_ + '&CommandType=' + CommandType_ + '&LocationId=' + LocationId 
                                   }
                                </script>

                            </div>
                        </div>

                    </div>
                    <br />
                }

                <table id="example" class="table table-responsive table-striped table-hover" style=" font-size:11px;">
                    <tr>
                        <th>
                            @Html.ActionLink("Service Type", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "ServiceType" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Service No", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "ServiceNo" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Rank", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "Rank" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Name With Initials", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "Name" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Allowance Name", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "AllowanceName" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Effective Date", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "EffectiveDate" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("End Date", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "EffectiveDate" }, null)
                        </th>
                        <th>
                            @Html.ActionLink("Authority", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "EffectiveDate" }, null)

                        </th>
                        <th>
                            @Html.ActionLink("Authority Date", "RejectList_StationVice", "FixedAllowanceDetail", new { sortOrder = "EffectiveDate" }, null)
                        </th>
                    </tr>

                    @foreach (var item in Model)
                    {
                        <tr>

                            <td>
                                @Html.DisplayFor(modelItem => item.Service_Type)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ServiceNo)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Rank)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Name)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.AllowanceName)
                            </td>
                            <td>
                                @Convert.ToString(string.Format("{0:dd/MM/yyyy}", item.EffectiveDate))
                            </td>
                            <td>
                                @Convert.ToString(string.Format("{0:dd/MM/yyyy}", item.EndDate))
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.CampAuthority)
                            </td>
                            <td>
                                @Convert.ToString(string.Format("{0:dd/MM/yyyy}", item.CampAuthorityDate))
                            </td>
                        </tr>
                    }
                </table>
                <br />
                @{
                    string EffectiveDateFrom = Request.QueryString["EffectiveDateFrom"];
                    string EffectiveDateTo = Request.QueryString["EffectiveDateTo"];
                    string LocationId = Request.QueryString["LocationId"];
                }
                @*Paging for Data Table *use only MVC no Javascript*@
                Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
                @Html.PagedListPager(Model, page => Url.Action("ForwerdList_StationVice",
                          new { page, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter, EffectiveDateFrom = EffectiveDateFrom, EffectiveDateTo = EffectiveDateTo, CommandType = '1', LocationId = LocationId }))

            </div>

        </div>
    </section>
</div>
<script src="~/packages/jQuery.1.10.2/Content/Scripts/jquery-1.10.2.js"></script>
<script type="text/javascript">
    $(function () {
        $('#LocationID ').submit(function () {
            var obj_LeaveHeader = {};
            obj_LeaveHeader.FromDate = $("#FromDate").val();
            obj_LeaveHeader.ToDate = $("#Todate").val();
            var Todate = $("#Todate").val();
            var FromDate = $("#FromDate").val();
            //  alert(Todate);
            $.ajax({
                type: 'POST',
                url: './DateCalc',
                dataType: 'json',
                data: '{obj_LeaveHeader: ' + JSON.stringify(obj_LeaveHeader) + '}',
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    $("#TotalDays").val(data.TotalDays);
                },
                error: function (result) {
                    // alert("some");
                }
            });
        })
    });
</script>

@Scripts.Render("~/bundles/jquery")